<div class="border rounded-lg border-gray-400 p-4">
  <input
    *ngIf="!disableInteraction"
    [formControl]="searchValueControl"
    type="text"
    class="flex-1 p-1 border border-gray-400 rounded-md mb-2 w-full max-w-[400px]"
    placeholder="Rechercher des milestones"
  />

  <div class="p-2 rounded-md flex flex-col">
    <div *ngIf="!disableInteraction" class="mb-4">
      <button class="text-blue-500" (click)="toggleSelectAll()">
        Tout {{ selectAll ? "désélectionner" : "sélectionner" }}
      </button>
    </div>

    <p class="text-center flex-1 text-gray-500" *ngIf="milestones.length === 0">
      Aucune milestone {{ disableInteraction ? "selectionnée" : "trouvée" }}
    </p>
    <span *ngIf="!disableInteraction" class="mb-2">Dernières milestones</span>
    <ul class="list-none">
      <li class="flex items-center gap-2" *ngFor="let milestone of milestones">
        <!-- TODO: faire un composant pour afficher les milestones entries -->
        <div
          class="p-2 border rounded-lg bg-gray-100 flex gap-2 w-full items-center justify-between mb-2"
        >
          <label class="flex flex-1 items-center">
            <input
              *ngIf="!disableInteraction"
              type="checkbox"
              class="mr-2"
              [checked]="isSelected(milestone)"
              (change)="toggleMilestone(milestone)"
            />
            <span class="font-medium text-gray-700">{{ milestone.title }}</span>
          </label>

          <div class="flex items-center space-x-2">
            <span
              class="rounded-full px-2 py-1 text-xs font-semibold"
              [ngClass]="{
                'bg-red-300 text-red-800': milestone.state == 'closed',
                'bg-green-300 text-green-800': milestone.state == 'active'
              }"
            >
              {{ milestone.state === "closed" ? "Fermée" : "Ouverte" }}
            </span>
            <a
              class="px-2 py-1 text-xs font-semibold bg-blue-500 underline text-white rounded-full hover:bg-blue-600 transition duration-100"
              href="{{ getMilestoneURL(milestone) }}"
              target="_blank"
            >
              Ouvrir sur Gitlab
            </a>
          </div>
        </div>
      </li>
    </ul>
    <span
      class="mb-2"
      *ngIf="searchedMilestones.length > 0 && !disableInteraction"
      >Milestones recherchées</span
    >
    <ul class="list-none">
      <li
        class="flex items-center gap-2"
        *ngFor="let milestone of searchedMilestones"
      >
        <div
          class="p-2 border rounded-lg bg-gray-100 flex gap-2 w-full items-center justify-between mb-2"
        >
          <label class="flex flex-1 items-center">
            <input
              *ngIf="!disableInteraction"
              type="checkbox"
              class="mr-2"
              [checked]="isSelected(milestone)"
              (change)="toggleMilestone(milestone)"
            />
            <span class="font-medium text-gray-700">{{ milestone.title }}</span>
          </label>

          <div class="flex items-center space-x-2">
            <span
              class="rounded-full px-2 py-1 text-xs font-semibold"
              [ngClass]="{
                'bg-red-300 text-red-800': milestone.state == 'closed',
                'bg-green-300 text-green-800': milestone.state == 'active'
              }"
            >
              {{ milestone.state === "closed" ? "Fermée" : "Ouverte" }}
            </span>
            <a
              class="px-2 py-1 text-xs font-semibold bg-blue-500 underline text-white rounded-full hover:bg-blue-600 transition duration-100"
              href="{{ getMilestoneURL(milestone) }}"
              target="_blank"
            >
              Ouvrir sur Gitlab
            </a>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
